<!doctype html>
<html>
<head>
<title>Get a Passphrase - Generator for Strong Passphrases</title>
<link href="css/generate.css" rel="stylesheet" type="text/css" />
</head>
<body>
<section>
  <header>
  <h1>Get a Passphrase</h1>
  <p>Cryptographically Secure Passphrase Generator</p>
  </header>

  <div id="options">
    <h3>Get a random passphrase:</h3>
    <button id="refreshPassphrases"> ‚ôªÔ∏è Refresh!</button>
    <!-- Text input fields and labels will be generated here -->
  </div>

  <div>
    Practice typing the phrase
    <input class="practice" type="text">
  </div>
</section>

<section>
<h2>How does it work?</h2>
<p>
This website randomly selects words from predefined lists and arranges them into meaningful sentences.
These passphrases are millions of times stronger than most humanly-generated passwords, but reasonably easy to memorize, making them ideal for protecting your most important accounts.
</p>
</section>
<section>
  <h2>How long would it take to crack each?</h2>
  <label for="hashRateSelect">Select attacker's computing power*:</label><br>
  <select id="hashRateSelect" class="custom-dropdown">
    <option value="1e2">Online attack (10 guesses/second)</option>
    <option value="1e6">Slow attack (1 million guesses/second)</option>
    <option value="1e10">Standard Consumer GPU (10 billion guesses/second)</option>
    <option value="1e11">High-end GPU (100 billion guesses/second)</option>
    <option value="1e12" selected>Best Available Hardware (1 trillion guesses/second)</option>
    <option value="1e13">Nation State Attacker (10 trillion guesses/second)</option>
  </select>
  <table id="crack-timetable"></table>
  <em>* Best guesses as of 2024 computing power</em>
</section>
<footer></footer>
<script src="js/passphrasegenerator.js?v=20180129"></script>
<script>
"use strict";
document.addEventListener('DOMContentLoaded', function() {
  const optionsContainer = document.getElementById('options');
  const grammars = passphraseGenerator.getGrammars();
  const bitsOptions = Object.keys(grammars);
  
  bitsOptions.forEach(function(bits) {
    let container = document.createElement('div');
    container.className = 'passphrase-container';
    optionsContainer.appendChild(container);

    let label = document.createElement('label');
    label.textContent = bits + ' bits:';
    container.appendChild(label);

    let passphraseDiv = document.createElement('div');
    passphraseDiv.className = 'passphrase-output';
    passphraseDiv.dataset.bits = bits; // Ensure data-bits is set here
    container.appendChild(passphraseDiv);

    let copyBtn = document.createElement('button');
    copyBtn.textContent = 'üìã Copy';
    copyBtn.className = 'copy-button';
    container.appendChild(copyBtn);

    const copyToClipboard = () => {
      // Remove 'copied' class from all passphrase outputs
      document.querySelectorAll('.passphrase-container.copied').forEach(div => {
        div.classList.remove('copied');
      });
      document.querySelectorAll('.copy-button').forEach(button => {
        button.textContent = 'üìã Copy';
      })

      // Add 'copied' class to the current passphrase output
      passphraseDiv.closest('.passphrase-container').classList.add('copied');

      navigator.clipboard.writeText(passphraseDiv.textContent).then(() => {
        copyBtn.textContent = '‚úÖ Copied';
      });
    };

    copyBtn.onclick = copyToClipboard;
    passphraseDiv.onclick = copyToClipboard;

    generateAndDisplayPassphrase(bits, passphraseDiv); // Assuming this function exists and sets the initial passphrase text
  });

  // Add event listener to the dropdown
  document.getElementById('hashRateSelect').addEventListener('change', addCrackTimeTable);

  // Initially populate the table
  addCrackTimeTable();
});




let generateAndDisplayPassphrase = function(bits, displayElement) {
    let response = passphraseGenerator.getPassphrase(bits);
    if (response.status === "ok") {
        displayElement.textContent = response.message;
    } else {
        displayElement.textContent = "Error: " + response.message;
    }
};

document.getElementById('refreshPassphrases').addEventListener('click', function() {
  // Not elegant. But simplest way to get back to fresh state on everything 
  location.reload();
});

function addCrackTimeTable() {
    const hashRate = parseFloat(document.getElementById('hashRateSelect').value); // Get selected hash rate
    const grammars = passphraseGenerator.getGrammars();
    const bitsList = Object.keys(grammars).map(bits => parseInt(bits));
    
    const results = bitsList.map(bits => ({
        bits: bits,
        timeToCrack: convertTimeToReadableFormat(timeToCrack(bits, hashRate))
    }));

    // Create and append the table
    const table = document.getElementById('crack-timetable');
    table.innerHTML = ''; // Clear previous content
    table.className = 'table'; // Bootstrap class for styling
    const headerRow = table.insertRow();
    const headerCell1 = headerRow.insertCell();
    headerCell1.innerHTML = "<b>Bits of Entropy</b>";
    const headerCell2 = headerRow.insertCell();
    headerCell2.innerHTML = "<b>Time to Crack</b>";

    results.forEach(result => {
        const row = table.insertRow();
        const cell1 = row.insertCell();
        cell1.innerHTML = result.bits;
        const cell2 = row.insertCell();
        cell2.innerHTML = result.timeToCrack;
    });
}

function timeToCrack(bits, hashesPerSecond) {
    const totalCombinations = Math.pow(2, bits);
    const seconds = totalCombinations / (2 * hashesPerSecond);
    return seconds; // return time in seconds
}

function convertTimeToReadableFormat(seconds) {
    const minute = 60;
    const hour = minute * 60;
    const day = hour * 24;
    const year = day * 365;
    const century = year * 100;

    if (seconds < minute) {
        return parseInt(seconds.toFixed(0)).toLocaleString() + " seconds";
    } else if (seconds < hour) {
        return parseInt((seconds / minute).toFixed(0)).toLocaleString() + " minutes";
    } else if (seconds < day) {
        return parseInt((seconds / hour).toFixed(0)).toLocaleString() + " hours";
    } else if (seconds < year) {
        return parseInt((seconds / day).toFixed(0)).toLocaleString() + " days";
    } else if (seconds < century) {
        return parseInt((seconds / year).toFixed(0)).toLocaleString() + " years";
    } else {
        return parseInt((seconds / century).toFixed(0)).toLocaleString() + " centuries";
    }
}



</script>
</body>
</html>
