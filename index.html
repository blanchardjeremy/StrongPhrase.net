<!doctype html>
<html>
<head>
<title>Get a Passphrase - Generator for Strong Passphrases</title>
<link href="css/generate.css" rel="stylesheet" type="text/css" />
</head>
<body>
<section>
<header>
<h1>Get a Passphrase</h1>
<p>Cryptographically Secure Passphrase Generator</p>
</header>
<ol>
<li>Verify that the connection is secure.</li>
<li>
<div id="options">
<button id="refreshPassphrases">New Passphrases</button>

<h3>Get a random passphrase:</h3>
<!-- Text input fields and labels will be generated here -->
</div>
</li>
<li>Visualize the scene described by the phrase</li>
<li>Practice typing the phrase
<input class="practice" type="text">
<input class="practice" type="text">
</li>
</ol>
</section>

<section>
<h2>How does it work?</h2>
<p>
This website randomly selects words from predefined lists and arranges them into meaningful sentences.
These passphrases are millions of times stronger than most humanly-generated passwords, but reasonably easy to memorize, making them ideal for protecting your most important accounts.
</p>
</section>
<footer></footer>
<script src="js/passphrasegenerator.js?v=20180129"></script>
<script>
"use strict";

document.addEventListener('DOMContentLoaded', function() {
  const optionsContainer = document.getElementById('options');
  const grammars = passphraseGenerator.getGrammars();
  const bitsOptions = Object.keys(grammars);
  bitsOptions.forEach(function(bits) {
    let label = document.createElement('label');
    label.htmlFor = 'bit-' + bits;
    label.textContent = bits + ' bit passphrase:';
    optionsContainer.appendChild(label);

    let input = document.createElement('input');
    input.type = 'text';
    input.id = 'bit-' + bits;
    input.dataset.bits = bits; // Store bits in a data attribute
    optionsContainer.appendChild(input);
    optionsContainer.appendChild(document.createElement('br'));
    
    generateAndDisplayPassphrase(bits, input);
    input.addEventListener('input', function() {
      generateAndDisplayPassphrase(bits, input);
    });
  });
});

let generateAndDisplayPassphrase = function(bits, inputField) {
  let response = passphraseGenerator.getPassphrase(bits);
  if (response.status === "ok") {
    inputField.value = response.message; // Automatically fill the text box with the passphrase
  } else {
    inputField.value = "Error: " + response.message; // Display error if passphrase generation fails
  }
};

document.getElementById('refreshPassphrases').addEventListener('click', function() {
  document.querySelectorAll('input[type="text"]').forEach(input => {
    const bits = input.dataset.bits;
    if (bits) { // Check if the input field has the 'bits' data attribute
      generateAndDisplayPassphrase(bits, input);
    }
  });
});

</script>
</body>
</html>
